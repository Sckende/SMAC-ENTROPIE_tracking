---
title: "PSEATE - Localisations repro vs migration"
subtitle: "Exploration des données"
output:
  html_document:
    toc: true
    number_sections: true
    toc_float: true
---

```{r, include = F}
# Output figure in HTML5
if (knitr::is_html_output()) knitr::knit_hooks$set(
  plot = function(x, options) {
    cap  <- options$fig.cap  # figure caption
    tags <- htmltools::tags
    as.character(tags$figure(
      tags$img(src = x, alt = cap),
      tags$figcaption(cap)
    ))
  }
)

# packages
source("C:/Users/ccjuhasz/Desktop/SMAC/GITHUB/SMAC-ENTROPIE_tracking/PTEBAR-JUV/packages_list.r")

```

# Mise en contexte
  
## A développer
  

# Bilan data brutes  
   
```{r setup, include = FALSE}
pseate <- readRDS("C:/Users/ccjuhasz/Desktop/SMAC/Projet_publi/6-PNB_isotopes/DATA/GitHub_Pages/PSEATE_trips.rds")

pseate <- pseate[pseate$ID != "PNB-C2143", ]

pseate_sf <- st_as_sf(pseate,
                      coords = c("LON", "LAT"),
                      crs = 4326)

ll <- split(pseate_sf,
            pseate_sf$TYPE)

ll2 <- split(pseate_sf,
             pseate_sf$ID)

kern <- readRDS("C:/Users/ccjuhasz/Desktop/SMAC/Projet_publi/6-PNB_isotopes/DATA/GitHub_Pages/kernel50-90.rds")


library(knitr)
```

```{r, echo = F}
mapview(ll,
        col.region = c("#a9a9a976", "#000000a7"))


rg <- lapply(ll,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")

kable(rg2,
      row.names = T,
      caption = "Tab. 1.")

```

# Visualisation individuelle  

## C2127  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2127"]],
            ll2[["PNB-C2127"]]$TYPE)
ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2127"]][[2]], kern[["PNB-C2127"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 2.')
```
## C2127_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2127_2019"]],
            ll2[["PNB-C2127_2019"]]$TYPE)
ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2127_2019"]][[2]], kern[["PNB-C2127_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 3.')
```
## C2128  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2128"]],
            ll2[["PNB-C2128"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2128"]][[2]], kern[["PNB-C2128"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 4.')
```
## C2130  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2130"]],
            ll2[["PNB-C2130"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2130"]][[2]], kern[["PNB-C2130"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 5.')
```
## C2133   
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2133"]],
            ll2[["PNB-C2133"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2133"]][[2]], kern[["PNB-C2133"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 6.')
```
## C2133_2019
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2134"]],
            ll2[["PNB-C2133_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2134"]][[2]], kern[["PNB-C2134"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 7.')
```
## C2134  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2134"]],
            ll2[["PNB-C2134"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2134"]][[2]], kern[["PNB-C2134"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 8.')
```
## C2135  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2135"]],
            ll2[["PNB-C2135"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2135"]][[2]], kern[["PNB-C2135"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 9.')
```
## C2136  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2136"]],
            ll2[["PNB-C2136"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2136"]][[2]], kern[["PNB-C2136"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 10.')
```
## C2137  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2137"]],
            ll2[["PNB-C2137"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2137"]][[2]], kern[["PNB-C2137"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 11.')
```
## C2137_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2137_2019"]],
            ll2[["PNB-C2137_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2137_2019"]][[2]], kern[["PNB-C2137_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 12.')
```
## C2138  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2138"]],
            ll2[["PNB-C2138"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2138"]][[2]], kern[["PNB-C2138"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 13.')
```
## C2139  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2139"]],
            ll2[["PNB-C2139"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2139"]][[2]], kern[["PNB-C2139"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 14.')
```
## C2141  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2141"]],
            ll2[["PNB-C2141"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2141"]][[2]], kern[["PNB-C2141"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 15.')
```
## C2141_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2141_2019"]],
            ll2[["PNB-C2141_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2141_2019"]][[2]], kern[["PNB-C2141_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 16.')
```
## C2142  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2142"]],
            ll2[["PNB-C2142"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2142"]][[2]], kern[["PNB-C2142"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 17.')
```
## C2142_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2142_2019"]],
            ll2[["PNB-C2142_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2142_2019"]][[2]], kern[["PNB-C2142_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 18.')
```
## C2144  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2144"]],
            ll2[["PNB-C2144"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2144"]][[2]], kern[["PNB-C2144"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 19.')
```
## C2145  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2145"]],
            ll2[["PNB-C2145"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2145"]][[2]], kern[["PNB-C2145"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 20.')
```
## C2859_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2859_2019"]],
            ll2[["PNB-C2859_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2859_2019"]][[2]], kern[["PNB-C2859_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 21.')
```
## C2860_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2860_2019"]],
            ll2[["PNB-C2860_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2860_2019"]][[2]], kern[["PNB-C2860_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 22.')
```
## C2866_2019  
```{r, echo = F}
ll1 <- split(ll2[["PNB-C2866_2019"]],
            ll2[["PNB-C2866_2019"]]$TYPE)

ll3 <- list(ll1[[1]], ll1[[2]], kern[["PNB-C2866_2019"]][[2]], kern[["PNB-C2866_2019"]][[1]])
names(ll3) <-  c("migration", "reproduction", "kernel 90", "kernel 50")

mapview(ll3,
        col.region = c("#a9a9a976", "#000000a7", "#bfd1ff", "#004FFF"),
        color = c("#666699", "black", "#bfd1ff", "#004FFF"))

rg <- lapply(ll1,
             function(x) {
               date_min <- min(x$DATE)
               date_max <- max(x$DATE)
               n_loc <- nrow(x)
               
               dt <- data.frame(min_date = date_min,
                                   max_date = date_max,
                                   loc_number = n_loc)
               dt
                             })
rg2 <- do.call("rbind", rg)
row.names(rg2) <- c("MIGRATION", "REPRODUCTION")
kable(rg2,
      row.names = T,
      caption = 'Tab. 23.')
```
